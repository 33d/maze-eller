  10 REM W=MAZE WIDTH
  20 W = 38
  30 REM CHANCE A CELL WILL GROW TO THE RIGHT
  40 H = 0.5
  50 REM R=THIS ROW, P=PREV ROW
  60 DIM R(W-1)
  70 DIM P(W-1)

 100 REM COPY CURRENT TO PREVIOUS, CLEAR CURRENT
 110 GOSUB 1000
 120 REM FILL SOME COLUMNS DOWN
 130 GOSUB 1100
 140 REM FILL IN UNUSED CELLS
 150 GOSUB 1200
 160 REM COPY SOME CELLS RIGHT
 170 GOSUB 1400
 180 REM DISPLAY THE ROW
 190 GOSUB 1600
 200 GOTO 100

1000 REM COPY CURRENT TO PREVIOUS, CLEAR CURRENT
1010 FOR I = 0 TO W-1
1020 P(I) = R(I)
1030 R(I) = 0
1040 NEXT I
1050 RETURN

1100 REM FILL ONE COLUMN DOWN FOR EACH GROUP
1110 I=0
1120 S=I
1130 E=I
1140 E=E+1
1150 IF E = W-1 THEN GOTO 1170
1160 IF P(E)=P(E-1) THEN GOTO 1140
1170 S = S + INT(RND(0) * (E-S))
1180 R(S) = P(S)
1190 I = E
1191 IF I < W-1 THEN GOTO 1120
1192 RETURN

1200 REM FILL IN UNUSED CELLS
1210 FOR I = 0 TO W-1
1220 IF R(I) <> 0 THEN GOTO 1330
1230 REM FIND A SPARE NUMBER
1240 E = 1
1250 S = 0
1260 IF R(S) = E THEN GOTO 1300
1270 S = S + 1
1280 IF S = W THEN GOTO 1320
1290 GOTO 1260
1300 E = E + 1
1310 GOTO 1250
1320 R(I) = E
1330 NEXT I
1340 RETURN

1400 REM FILL CELLS RIGHT
1410 FOR I = 0 TO W-2
1420 IF RND(1) > H THEN GOTO 1550
1430 REM IF THE PREVIOUS ROW IS JOINED
1440 REM DO NOT JOIN THIS ONE
1450 IF P(I) = P(I+1) THEN GOTO 1550
1460 S = R(I)
1470 E = R(I+1)
1480 R(I+1) = S
1490 REM CHANGE THE PREVIOUS ROW TOO
1500 J = I+1
1510 IF P(J) <> E THEN GOTO 1550
1520 P(J) = S
1530 J = J + 1
1540 IF J < W THEN GOTO 1510
1550 NEXT I
1560 RETURN

1600 REM DISPLAY THE ROW
1610 FOR I = 0 TO W-1
1620 IF I = 0 THEN GOTO 1660
1630 IF R(I-1) <> R(I) THEN GOTO 1660
1640 PRINT " ";
1650 GOTO 1670
1660 PRINT "|";
1670 IF R(I) = P(I) THEN GOTO 1700
1680 PRINT "'";
1690 GOTO 1710
1700 PRINT " ";
1710 NEXT I
1720 PRINT "|"
1730 RETURN
